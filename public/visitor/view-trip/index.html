<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono&display=swap">
    <link href="https://cdn.rawgit.com/michalsnik/aos/2.1.1/dist/aos.css" rel="stylesheet">

    <title>Miviajea Vietnam</title>
    <link rel="icon" href="../images/logo.png">
</head>

<body data-spy="scroll" data-target=".navbar" data-offset="50">
    <div id="Welcome">
        <!---Start navigation Bar -->
        <nav class="navbar navbar-expand-lg navbar fixed-top  navbar-light bg-light">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
                aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href=""> Miviajea Vietnam</a>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#welcome">Welcome</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#before-trip">Before the trip</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#flight-info">Flight info</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#about-vietnam">About Vietnam</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#trips">Our trip</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#about">About Us</a>
                    </li>
                </ul>
            </div>

            <div class="dropdown">
                <button class="btn only-pc dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                        <path
                            d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0" />
                    </svg>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <button class="btn btn-primary btn-block text-center dropdown-item"
                        style="color: #fff;background-color: #007bff;border-color: #007bff;" href="tel:++390000000">
                        <i class="fa fa-phone" aria-hidden="true"></i>+84 3304490623</button>
                    <button class="btn btn-success btn-block text-center dropdown-item"
                        style="color: #fff;background-color: #28a745;border-color: #28a745;"
                        href="https://api.whatsapp.com/send?phone=+390000000">
                        <i class="fab fa-whatsapp" aria-hidden="true"></i> Whatsapp</button>

                </div>
            </div>
        </nav>
        <!--- End Navigation Bar -->

        <div class="row">
            <div class="col-lg-12" data-aos="fade-up">
                <img class="d-block w-100 img-fluid img-slider" src="../images/vietnam.jpeg">
            </div>
        </div>
    </div>

    <!--- Welcome-->
    <div class="container">
        <div class="row" id="welcome">
            <div class="col navMenu">
                <h2 class="text-center"><i class="far fa-bookmark" style='color:red'></i> Welcome </h2>
            </div>
        </div>
        <div class="row bg-light">
            <div class="col-md-6">
                <h3 id="greeting-message">Hi,</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore
                    et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut
                    aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
                    culpa qui officia deserunt mollit anim id est laborum.

                </p>
            </div>
            <div class="col-md-6 pt-3" data-aos="fade-up">
                <img class="img-fluid" src="../images/aodai.jpeg">
            </div>
        </div>
        <div class="row bg-light"><br></div>

        <!--- End of Welcome -->

        <div class="row" id="before-trip">
            <div class="col navMenu">
                <h2 class="text-center"><i class='far fa-bell' style='color:red'></i> Before the trip </h2>
            </div>
        </div>
        <div class="row bg-light" id="before-trip-content">
            <!-- // content will be added here -->
        </div>

        <!-- Flight info -->
        <div class="row" id="flight-info">
            <div class="col navMenu">
                <h3 class="text-center"><i class='far fa-paper-plane' style='color:red'></i> Flight Information </h3>
            </div>
        </div>
        <div class="row bg-light">
            <div class="col-12 p-3" data-aos="slide-up">
                <div class="card flight-card">
                    <div class="card-body">
                        <p><i class="fas fa-calendar"></i> Departure</p>
                        <div class="row card-text">
                            <div class="col-5">
                                <div class="row">
                                    <div class="col-9">
                                        <span class="one-line no-break-line" id="de-from-date">1/1/22000</span>
                                        <span class="one-line no-break-line" id="de-from-time">12:00</span>
                                    </div>
                                    <p class="col-3 no-break-line" id="de-from-location"></p>
                                </div>

                            </div>
                            <div class="col-2">
                                <i class="fas fa-plane plane-animation" style="color: rgb(104, 168, 224);"></i>
                            </div>
                            <div class="col-5">
                                <div class="row">
                                    <div class="col-9">
                                        <span class="one-line no-break-line" id="de-to-date">1/1/22000</span>
                                        <span class="one-line no-break-line" id="de-to-time">12:00</span>
                                    </div>
                                    <p class="col-3 no-break-line" id="de-to-location"></p>
                                </div>

                            </div>

                        </div>
                        <hr>
                        <p><i class="fas fa-calendar"></i> Arrival</p>
                        <div class="row card-text">
                            <div class="col-5">
                                <div class="row">
                                    <div class="col-9">
                                        <span class="one-line no-break-line" id="ar-from-date">1/1/22000</span>
                                        <span class="one-line no-break-line" id="ar-from-time">12:00</span>
                                    </div>
                                    <p class="col-3 no-break-line" id="ar-from-location">HN</p>
                                </div>

                            </div>
                            <div class="col-2">
                                <i class="fas fa-plane plane-animation" style="color: rgb(104, 168, 224);"></i>
                            </div>
                            <div class="col-5">
                                <div class="row">
                                    <div class="col-9">
                                        <span class="one-line no-break-line" id="ar-to-date">1/1/22000</span>
                                        <span class="one-line no-break-line" id="ar-to-time">12:00</span>
                                    </div>
                                    <p class="col-3 no-break-line" id="ar-to-location">HN</p>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--- Start of About Vietnam-->
        <div class="row" id="about-vietnam">
            <div class="col navMenu">
                <h2 class="text-center"><i class='far fa-flag' style='color:red'></i> About VietNam </h2>
            </div>
        </div>
        <div class="row">
            <div id="carouselExampleIndicators" class="col-lg-12 carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100 img-fluid img-slider" src="../images/slider3.jpeg" alt="First slide">
                        <div class="carousel-caption">
                            <button class="btn btn-info img-buton">View detail</button>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100 img-fluid img-slider" src="../images/slider2.jpeg" alt="Second slide">
                        <div class="carousel-caption">
                            <button class="btn btn-info img-buton">View detail</button>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100 img-fluid img-slider" src="../images/slider3.jpeg" alt="Third slide">
                        <div class="carousel-caption">
                            <button class="btn btn-info img-buton">View detail</button>
                        </div>
                    </div>
                </div>

                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
        <br>

        <!-- Our trip -->
        <div class="row" id="trips">
            <div class="col navMenu">
                <h3 class="text-center"><i class='fas fa-map-marker-alt' style='color:red'></i> Destinations </h3>
            </div>
        </div>
        <div class="bg-light">
            <div class="timeline p-2" id="list-destination-1">
                <!-- // content will be added here -->
            </div>
        </div>

        <!-- Comment and rate -->
        <div class="row" id="comment-rate">
            <div class="col navMenu">
                <h3 class="text-center"><i class='far fa-comment' style='color:red'></i> Comment and feedback</h3>
            </div>
        </div>
        <div class="row bg-light">
            <div class="col-md-12 p-3">
                <div class="">
                    <div class="form-group col-12">
                        <input class="form-control" id="commentName" placeholder="Name"></input>
                    </div>
                    <div class="form-group col-12">
                        <textarea class="form-control" rows="4" id="commentContent"
                            placeholder="Leave a comment"></textarea>
                    </div>
                    <!-- add image attach here -->
                    <div class="form-group col-12">
                        <button class="btn btn-sm btn-outline-success" onclick="files.click()">Attachment</button>
                        <input type="file" id="files" multiple>
                    </div>
                    <!-- Submit button -->
                    <div class="row justify-content-end mr-1">
                        <div class="col-auto">
                            <button class="btn btn-outline-primary">Post comment</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    </div>

    <div class="row footer bg-light">
        <div class="col">
            <p class="text-center">Follow us: <a class="social-icon">
                    <i class="fab fa-facebook"></i>
                </a> <a class="social-icon"></a><i class="fab fa-instagram"></i></a></p>
        </div>
        <div class="col">
            <p class="text-center">Copyright &copy; 2024</p>
        </div>
        <div class="col">
            <p class="text-center">Powered by: Miviajea Vietnam</a></p>
        </div>
    </div>
    </div>
    <footer class="container">
        <div class="row only-mobile">
            <div class="col-6">
                <a class="btn btn-primary btn-block text-center" href="tel:++390000000"><i class="fa fa-phone"
                        aria-hidden="true"></i> Call</a>
            </div>
            <div class="col-6">
                <a class="btn btn-success btn-block text-center"
                    href="https://api.whatsapp.com/send?phone=+390000000"><i class="fab fa-whatsapp"
                        aria-hidden="true"></i> Whatsapp</a>
            </div>
        </div>
    </footer>
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
    <script type="text/javascript" src="../js/smooth-scroll.js"></script>
    <script src="https://cdn.rawgit.com/michalsnik/aos/2.1.1/dist/aos.js"></script>
    <script type="text/javascript" src="../js/image-effect.js"></script>
    <script src="../../pub-variables.js"></script>

    <script>
        // get id from href ?id=1
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');

        // set id to local storage
        localStorage.setItem('trip-id', id);

        // check if localStorage has visitor-token or not
        if (!localStorage.getItem('visitor-token')) {
            window.location.href = '/visitor-login.html';
        }

        var beforeTrip;
        var flightInfo;
        // get trip data using fetch
        if (id) {
            // fetch data from API
            fetch(apiPublic + `/trip/${id}`)
                .then(response => response.json())
                .then(data => {

                    if(data.error){
                        // set this url to local storage
                        localStorage.setItem('404-url', window.location.href);
                        window.location.href = '/404.html';           
                    }
                    // set data for greeting
                    document.getElementById('greeting-message').innerHTML = `Hi, ${data.Client}`;

                    // check if ReminderInfo not empty then parse to json
                    if (data.ReminderInfo) {
                        beforeTrip = JSON.parse(data.ReminderInfo);
                    }
                    if (data.FlightInfo) {
                        flightInfo = JSON.parse(data.FlightInfo);
                    }

                    // generate before the trip based on beforeTrip
                    if (beforeTrip) {
                        let beforeTripContent = '';
                        for (let i = 0; i < beforeTrip.length; i++) {
                            if (beforeTrip[i].Title != '') {
                                beforeTripContent += `
                            <div class="col-md-4 p-3" data-aos="slide-up">
                                <div class="card view zoom">
                                    <div class="card-body">
                                        <h5 class="card-title"><i class='fas fa-exclamation-circle' style='color:red'></i> ${beforeTrip[i].Title} </h5>
                                        <ul class="list-group list-group-flush">`;
                                var listContent = beforeTrip[i].Content.split(';');
                                for (let j = 0; j < listContent.length; j++) {
                                    beforeTripContent += `<li class="list-group-item">${listContent[j]}</li>`
                                }
                                beforeTripContent += `</ul>
                                    </div>
                                </div>
                            </div>`;
                            }
                        }
                        document.getElementById('before-trip-content').innerHTML = beforeTripContent;
                    }


                    // generate flight info based on flightInfo
                    if (flightInfo) {
                        document.getElementById('de-from-date').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Departure.Departure).Date;
                        document.getElementById('de-from-time').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Departure.Departure).Time;
                        document.getElementById('de-from-location').innerHTML = flightInfo.Departure.From;

                        document.getElementById('de-to-date').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Departure.Arrival).Date;
                        document.getElementById('de-to-time').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Departure.Arrival).Time;
                        document.getElementById('de-to-location').innerHTML = flightInfo.Departure.To;

                        document.getElementById('ar-from-date').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Return.Departure).Date;
                        document.getElementById('ar-from-time').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Return.Departure).Time;
                        document.getElementById('ar-from-location').innerHTML = flightInfo.Return.From;

                        document.getElementById('ar-to-date').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Return.Arrival).Date;
                        document.getElementById('ar-to-time').innerHTML = convertDateToDDMMYYYYHHMM(flightInfo.Return.Arrival).Time;
                        document.getElementById('ar-to-location').innerHTML = flightInfo.Return.To;
                    }

                    // generate destination based on data to list destination
                    if (data.DestinationIds) {
                        fetch(apiPublic + `/destination/list/${data.DestinationIds}`)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                console.log(data);
                                let listDestination = '';
                                for (let i = 0; i < data.length; i++) {
                                    var lr = i % 2 == 0 ? 'left' : 'right';
                                    listDestination += `
                                    <div class="container-timeline ${lr}">
                                        <div class="content" onclick="destinationDetail(${data[0].Id})">
                                            <h2>${data[i].Name}</h2>
                                            <p>${data[i].Description}</p>
                                        </div>
                                    </div>`;
                                }
                                document.getElementById('list-destination-1').innerHTML = listDestination;
                            })
                            .catch(error => {
                                console.error('There was a problem with the fetch operation:', error);
                            });
                    }

                })
                .catch(error => {
                    console.error('There was a problem with the fetch operation:', error);
        
                });
            };

        // get destination detail
        function destinationDetail(id) {
            window.location.href = `/visitor/view-destination/?id=${id}`;
        }

        function convertDateToDDMMYYYYHHMM(dateString) {
            var date = new Date(dateString);
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();

            return {
                Date: `${day}/${month}/${year}`,
                Time: `${date.getHours()}:${date.getMinutes()}`
            }

        }
    </script>

</body>

</html>